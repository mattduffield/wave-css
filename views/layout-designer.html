<!DOCTYPE html>
<html lang="en" class="theme-azure light">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Layout JSON Designer</title>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/uuid/8.3.2/uuid.min.js"></script>
  <link href="layout-designer.css" rel="stylesheet">

  <link href="https://mattduffield.github.io/wave-css/dist/wave-css.css" rel="stylesheet" type="text/css">
  
  <script type="module" src="https://mattduffield.github.io/wave-css/dist/wave-css.js"></script>
  <script src="https://mattduffield.github.io/wave-css/dist/wave-helpers.js"></script>
  <script src="https://mattduffield.github.io/lite-spec/dist/lite-spec.js"></script>

  <script src="https://cdn.jsdelivr.net/npm/sortablejs@latest/Sortable.min.js"></script>

</head>
<body>
  <div class="flex flex-row flex-1 h-screen xdesigner-container">
    <!-- Left Panel - Elements -->
    <div class="flex flex-col panel left-panel">
      <h5>Containers</h5>
      <div class="element-list" id="container-elements">
        <div class="element-item" data-element-type="wc-tab" draggable="true">Tab Container</div>
        <div class="element-item" data-element-type="wc-tab-item" draggable="true">Tab Item</div>
        <div class="element-item" data-element-type="column" draggable="true">Column</div>
        <div class="element-item" data-element-type="row" draggable="true">Row</div>
        <div class="element-item" data-element-type="fieldset" draggable="true">Fieldset</div>
        <div class="element-item" data-element-type="array" draggable="true">Array</div>
        <div class="element-item" data-element-type="wc-card" draggable="true">Card</div>
      </div>
      
      <h5>Form Elements</h5>
      <div class="element-list" id="form-elements">
        <div class="element-item" data-element-type="wc-input" draggable="true">Input</div>
        <div class="element-item" data-element-type="wc-input-checkbox" draggable="true">Checkbox</div>
        <div class="element-item" data-element-type="hr" draggable="true">Horizontal Line</div>
      </div>
      
      <h5>Schema Fields</h5>
      <div class="element-list" id="schema-fields">
        <!-- Will be populated dynamically -->
      </div>
    </div>

    <!-- Center Panel - Designer Surface -->
    <div id="center-panel" class="flex flex-col flex-1 min-h-0" style="background-color: red;">
      <wc-tab id="center-tab-control" class="flex flex-col flex-1 min-h-0 p-2" animate>
        <wc-tab-item class="active" label="Canvas">
          <div class="designer-surface min-h-200 max-h-700 overflow-scroll" id="designer-surface" style="background-color: green;"></div>
        </wc-tab-item>
        <wc-tab-item label="Schema">
          <div class="col-1 gap-2 p-4">
            <wc-code-mirror class="min-h-200 max-h-700"
              name="schema-json"
              line-numbers
              line-wrapper
              fold-gutter
              mode="javascript"
              theme="monokai"
              tab-size="2"
              indent-unit="2">
            </wc-code-mirror>
            <button id="load-schema" class="btn btn-primary">Load Schema</button>
          </div>
        </wc-tab-item>
        <wc-tab-item class="" label="Preview">
          <div class="p-4" id="preview-container">
            <div id="preview-content"></div>
          </div>
        </wc-tab-item>
        <wc-tab-item class="h-full" label="Layout JSON">
          <wc-code-mirror class="min-h-200 max-h-700"
            name="json-output"
            line-numbers
            line-wrapper
            fold-gutter
            mode="javascript"
            theme="monokai"
            tab-size="2"
            indent-unit="2">
          </wc-code-mirror>
        </wc-tab-item>
        <wc-tab-item class="flex-1 min-h-0" label="Pre Rendered Preview">
          <iframe id="pre-rendered-preview" name="pre-rendered-preview" class="block border-none min-h-0 h-full w-full">
          </iframe>
        </wc-tab-item>
        <wc-tab-item class="flex-1 min-h-0" label="Rendered Preview">
          <iframe id="rendered-preview" name="rendered-preview" class="block border-none min-h-0 h-full w-full">
          </iframe>
        </wc-tab-item>
      </wc-tab>
    </div>
    <!-- Right Panel - Properties -->
    <div class="flex flex-col xpanel right-panel">
      <wc-tab id="right-panel" class="flex flex-col flex-1 p-2" animate>
        <wc-tab-item class="active" label="Properties">
          <div class="col-1 gap-2 pt-2 pb-10 px-4">
            <div id="no-selection" class="col-1 text-center text-muted py-4">
              <p>Select an element to view and edit its properties</p>
            </div>
            <div id="element-properties" class="col-1 gap-2 hidden">
              <div class="row">
                <wc-input name="prop-id" lbl-label="ID" class="col-1" readonly></wc-input>
              </div>
              <div class="row">
                <wc-input name="prop-type" lbl-label="Type" class="col-1" readonly></wc-input>
              </div>
              <div class="row">
                <wc-input name="prop-label" lbl-label="Label" class="col-1"></wc-input>
              </div>
              <div class="row">
                <wc-input name="prop-scope" lbl-label="Scope" class="col-1"></wc-input>
              </div>
              <div class="row">
                <wc-input name="prop-css" lbl-label="CSS" class="col-1"></wc-input>
              </div>
              <div class="row">
                <wc-input name="prop-required" lbl-label="Required" class="col" type="checkbox" toggle-switch></wc-input>
              </div>
              <div class="row">
                <button id="save-properties" class="col-1 btn btn-primary">Apply</button>
              </div>
            </div>
          </div>
        </wc-tab-item>
        <wc-tab-item class="p-4" label="Rules">
          <div class="col-1 gap-2 pt-2 pb-10 px-10">
            <div id="rules-no-selection" class="text-center text-muted py-4">
              <p>Select an element to view and edit its rules</p>
            </div>
            <div id="element-rules" class="d-none">
              <div id="rules-list">
                <!-- Rules will be added here -->
              </div>
              <button id="add-rule" class="btn btn-primary mt-3">Add Rule</button>
            </div>
          </div>
        </wc-tab-item>
      </wc-tab>

    </div>
  </div>
  
  <!-- Rule Modal -->
  <div class="modal fade" id="rule-modal" tabindex="-1" aria-hidden="true">
    <div class="modal-dialog modal-lg">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title">Edit Rule</h5>
          <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
        </div>
        <div class="modal-body">
          <div class="mb-3">
            <label for="rule-effect" class="form-label">Effect</label>
            <select class="form-select" id="rule-effect">
              <option value="COPY">Copy Value</option>
              <option value="COPY-TOLOWER">Copy to Lowercase</option>
              <option value="COPY-TOLOWER-UNDERSCORE">Copy to Lowercase with Underscores</option>
              <option value="SHOW">Show Element</option>
              <option value="HIDE">Hide Element</option>
              <option value="ENABLE">Enable Element</option>
              <option value="DISABLE">Disable Element</option>
              <option value="REQUIRE">Make Required</option>
              <option value="UN-REQUIRE">Make Optional</option>
            </select>
          </div>
          
          <h6>Condition</h6>
          <div class="mb-3">
            <label for="rule-condition-scope" class="form-label">Scope</label>
            <input type="text" class="form-control" id="rule-condition-scope">
          </div>
          
          <div class="mb-3">
            <label class="form-label">Schema Validation</label>
            <div class="row g-2">
              <div class="col-md-4">
                <select class="form-select" id="rule-schema-type">
                  <option value="minLength">Min Length</option>
                  <option value="maxLength">Max Length</option>
                  <option value="pattern">Pattern</option>
                  <option value="minimum">Minimum</option>
                  <option value="maximum">Maximum</option>
                  <option value="const">Constant</option>
                  <option value="enum">Enum</option>
                </select>
              </div>
              <div class="col-md-8">
                <input type="text" class="form-control" id="rule-schema-value" placeholder="Value">
              </div>
            </div>
          </div>
          
          <div class="mb-3">
            <label for="rule-src-data-id" class="form-label">Source Element ID</label>
            <input type="text" class="form-control" id="rule-src-data-id">
          </div>
          
          <div class="mb-3">
            <label for="rule-src-selector" class="form-label">Source Selector (optional)</label>
            <input type="text" class="form-control" id="rule-src-selector" placeholder="e.g. input">
          </div>
          
          <div class="mb-3">
            <label for="rule-src-property" class="form-label">Source Property (optional)</label>
            <input type="text" class="form-control" id="rule-src-property" placeholder="e.g. value">
          </div>
          
          <h6>Target</h6>
          <div class="mb-3">
            <label for="rule-tgt-data-id" class="form-label">Target Element ID</label>
            <input type="text" class="form-control" id="rule-tgt-data-id">
          </div>
          
          <div class="mb-3">
            <label for="rule-tgt-selector" class="form-label">Target Selector (optional)</label>
            <input type="text" class="form-control" id="rule-tgt-selector" placeholder="e.g. input">
          </div>
          
          <div class="mb-3">
            <label for="rule-tgt-property" class="form-label">Target Property</label>
            <input type="text" class="form-control" id="rule-tgt-property" placeholder="e.g. value">
          </div>
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
          <button type="button" class="btn btn-primary" id="save-rule">Save Rule</button>
        </div>
      </div>
    </div>
  </div>
  
  <!--
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/js/bootstrap.bundle.min.js"></script>
  -->
  <script src="layout-designer.js"></script>
</body>
</html>